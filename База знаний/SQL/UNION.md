
# Оператор UNION в SQL

## Содержание ^c58d3f9a
- [Введение](#^a2b4c6d8)
- [Что такое UNION?](#^e1f3g5h7)
- [Синтаксис UNION](#^i9j1k3l5)
- [Типы UNION](#^m7n9o1p3)
  - [UNION](#^q5r7s9t1)
  - [UNION ALL](#^u3v5w7x9)
- [Правила использования UNION](#^y1z2a3b4)
- [Примеры использования](#^c5d6e7f8)
- [Заключение](#^g9h0i1j2)

## Введение ^a2b4c6d8
Оператор UNION является одним из важнейших инструментов в SQL для объединения результатов нескольких запросов. Этот оператор позволяет комбинировать данные из разных таблиц или запросов в единый результирующий набор, что особенно полезно при работе с нормализованными базами данных или при необходимости агрегации информации из различных источников.

[↑ К содержанию](#^c58d3f9a)

## Что такое UNION? ^e1f3g5h7
UNION — это оператор SQL, который используется для объединения результирующих наборов двух или более SELECT-запросов. Основные характеристики:

- Объединяет строки из разных запросов
- Автоматически удаляет дубликаты (в базовой форме)
- Требует одинаковой структуры результирующих столбцов
- Часто используется для объединения данных из разных таблиц со схожей структурой

<small>Важно: UNION не следует путать с JOIN, который объединяет столбцы, а не строки.</small>

[↑ К содержанию](#^c58d3f9a)

## Синтаксис UNION ^i9j1k3l5
Базовый синтаксис оператора UNION:

```sql
SELECT column1, column2, ...
FROM table1
UNION
SELECT column1, column2, ...
FROM table2;
```

<big>**Ключевые требования к синтаксису:**</big>

- Количество столбцов в каждом SELECT должно совпадать
- Типы данных соответствующих столбцов должны быть совместимы
- Имена столбцов берутся из первого SELECT-запроса
- Порядок столбцов должен быть одинаковым

[↑ К содержанию](#^c58d3f9a)

## Типы UNION ^m7n9o1p3
В SQL существует два основных варианта оператора UNION, которые отличаются обработкой дублирующихся строк.

### UNION ^q5r7s9t1
Базовая форма оператора, которая автоматически удаляет дубликаты из результирующего набора.

```sql
SELECT product_name FROM products_2023
UNION
SELECT product_name FROM products_2024;
```

<small>В этом примере повторяющиеся названия продуктов будут показаны только один раз.</small>

[↑ К содержанию](#^c58d3f9a)

### UNION ALL ^u3v5w7x9
Модификация оператора, которая сохраняет все строки, включая дубликаты.

```sql
SELECT product_name FROM products_2023
UNION ALL
SELECT product_name FROM products_2024;
```

<small>UNION ALL работает быстрее, так как не требует проверки на дубликаты.</small>

[↑ К содержанию](#^c58d3f9a)

## Правила использования UNION ^y1z2a3b4
При работе с оператором UNION необходимо соблюдать следующие правила:

<table>
<tr>
<td><strong>Правило</strong></td>
<td><strong>Описание</strong></td>
<td><strong>Пример</strong></td>
</tr>
<tr>
<td>Совместимость типов данных</td>
<td>Соответствующие столбцы должны иметь совместимые типы данных</td>
<td>VARCHAR можно объединять с TEXT</td>
</tr>
<tr>
<td>Количество столбцов</td>
<td>Все SELECT-запросы должны возвращать одинаковое количество столбцов</td>
<td>Ошибка: SELECT id, name UNION SELECT id</td>
</tr>
<tr>
<td>Порядок выполнения</td>
<td>UNION выполняется после отдельных SELECT-запросов</td>
<td>Сначала выполняются оба SELECT, затем UNION</td>
</tr>
<tr>
<td>Сортировка</td>
<td>ORDER BY применяется ко всему результирующему набору</td>
<td>ORDER BY должен быть в конце всего запроса</td>
</tr>
</table>

[↑ К содержанию](#^c58d3f9a)

## Примеры использования ^c5d6e7f8
### Пример 1: Объединение данных из разных таблиц
```sql
-- Объединение списка сотрудников из разных филиалов
SELECT employee_id, name, 'Москва' as branch 
FROM moscow_employees
UNION
SELECT employee_id, name, 'Санкт-Петербург' as branch 
FROM spb_employees
ORDER BY name;
```

### Пример 2: UNION с разными условиями
```sql
-- Получение уникальных клиентов из разных периодов
SELECT customer_id, customer_name 
FROM orders_2023
WHERE amount > 1000
UNION
SELECT customer_id, customer_name 
FROM orders_2024
WHERE status = 'active';
```

### Пример 3: Комбинирование UNION и агрегатных функций
```sql
-- Статистика по продажам за разные годы
SELECT '2023' as year, COUNT(*) as sales_count 
FROM sales_2023
UNION
SELECT '2024' as year, COUNT(*) as sales_count 
FROM sales_2024;
```

<small>Все примеры проверены на совместимость типов данных и количество столбцов.</small>

[↑ К содержанию](#^c58d3f9a)

## Заключение ^g9h0i1j2
Оператор UNION является мощным инструментом для работы с данными в SQL. Его основные преимущества:

- Объединение данных из различных источников
- Устранение дубликатов (в режиме UNION)
- Гибкость в комбинировании запросов
- Улучшение читаемости сложных запросов

<big>**Рекомендации по использованию:**</big>
- Используйте UNION ALL когда дубликаты допустимы или нужны для повышения производительности
- Всегда проверяйте совместимость типов данных в объединяемых столбцах
- Используйте псевдонимы для улучшения читаемости результирующего набора

[↑ К содержанию](#^c58d3f9a)

**Теги:** #sql #union #базы-данных #запросы #объединение-данных
```