<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Документация по явным операциям соединения в SQL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            max-width: 1200px;
        }
        .toc {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 20px;
        }
        .toc li {
            margin: 5px 0;
        }
        .toc a {
            text-decoration: none;
            color: #0066cc;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
        }
        h3 {
            color: #444;
            margin-top: 25px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background-color: #f8f8f8;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow-x: auto;
            line-height: 1.4;
        }
        .example {
            background-color: #e7f3ff;
            padding: 15px;
            border-left: 4px solid #0066cc;
            margin: 15px 0;
        }
        .note {
            background-color: #fff9e6;
            padding: 15px;
            border-left: 4px solid #ffcc00;
            margin: 15px 0;
        }
        .navigation {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <h1>Документация по явным операциям соединения в SQL</h1>

    <div class="toc">
        <h2>Содержание</h2>
        <ul>
            <li><a href="#introduction">Введение в операции соединения</a></li>
            <li><a href="#inner-join">INNER JOIN - внутреннее соединение</a></li>
            <li><a href="#left-join">LEFT JOIN - левое соединение</a></li>
            <li><a href="#right-join">RIGHT JOIN - правое соединение</a></li>
            <li><a href="#full-join">FULL JOIN - полное соединение</a></li>
            <li><a href="#cross-join">CROSS JOIN - перекрёстное соединение</a></li>
            <li><a href="#self-join">SELF JOIN - соединение таблицы с собой</a></li>
            <li><a href="#multiple-joins">Множественные соединения</a></li>
            <li><a href="#performance">Производительность и оптимизация</a></li>
            <li><a href="#navigation">Навигация</a></li>
        </ul>
    </div>

    <h2 id="introduction">Введение в операции соединения</h2>
    <p>SQL JOIN (соединение) - это операция, которая позволяет комбинировать строки из двух или более таблиц на основе связанного столбца между ними. Явные соединения используют ключевое слово JOIN в запросе.</p>
    
    <div class="example">
        <h3>Базовая структура JOIN</h3>
        <pre><code>SELECT столбцы
FROM таблица1
ТИП_JOIN таблица2 
ON таблица1.столбец = таблица2.столбец;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> Представьте, что у вас есть таблица "Студенты" и таблица "Оценки". JOIN позволяет объединить эти таблицы так, чтобы увидеть, какие оценки получил каждый студент. Ключевое слово ON указывает, по какому полю связывать таблицы (например, по ID студента).</p>

    <table>
        <thead>
            <tr>
                <th>Тип JOIN</th>
                <th>Описание</th>
                <th>Когда использовать</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>INNER JOIN</td>
                <td>Возвращает только совпадающие строки из обеих таблиц</td>
                <td>Когда нужны только данные, существующие в обеих таблицах</td>
            </tr>
            <tr>
                <td>LEFT JOIN</td>
                <td>Возвращает все строки из левой таблицы и совпадающие из правой</td>
                <td>Когда нужны все данные из основной таблицы, даже если нет соответствий</td>
            </tr>
            <tr>
                <td>RIGHT JOIN</td>
                <td>Возвращает все строки из правой таблицы и совпадающие из левой</td>
                <td>Когда нужны все данные из связанной таблицы</td>
            </tr>
            <tr>
                <td>FULL JOIN</td>
                <td>Возвращает все строки из обеих таблиц</td>
                <td>Когда нужны все данные из обеих таблиц</td>
            </tr>
            <tr>
                <td>CROSS JOIN</td>
                <td>Возвращает декартово произведение таблиц</td>
                <td>Когда нужно объединить каждую строку с каждой</td>
            </tr>
        </tbody>
    </table>

    <h2 id="inner-join">INNER JOIN - внутреннее соединение</h2>
    <p>INNER JOIN возвращает только те строки, для которых есть соответствие в обеих таблицах.</p>

    <div class="example">
        <h3>Пример INNER JOIN</h3>
        <pre><code>SELECT 
    students.name,
    grades.subject,
    grades.grade
FROM students
INNER JOIN grades ON students.id = grades.student_id;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> INNER JOIN работает как пересечение множеств. Только студенты, у которых есть оценки, и только оценки, которые привязаны к существующим студентам, будут включены в результат.</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: students</th>
                <th>Таблица: grades</th>
                <th>Результат INNER JOIN</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    id: 1, name: "Иван"<br>
                    id: 2, name: "Мария"<br>
                    id: 3, name: "Петр"
                </td>
                <td>
                    student_id: 1, subject: "Математика", grade: 5<br>
                    student_id: 2, subject: "Физика", grade: 4<br>
                    student_id: 4, subject: "Химия", grade: 3
                </td>
                <td>
                    Иван, Математика, 5<br>
                    Мария, Физика, 4
                </td>
            </tr>
        </tbody>
    </table>

    <h2 id="left-join">LEFT JOIN - левое соединение</h2>
    <p>LEFT JOIN возвращает все строки из левой таблицы и соответствующие строки из правой таблицы. Если соответствий нет, возвращаются NULL значения.</p>

    <div class="example">
        <h3>Пример LEFT JOIN</h3>
        <pre><code>SELECT 
    students.name,
    grades.subject,
    grades.grade
FROM students
LEFT JOIN grades ON students.id = grades.student_id;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> LEFT JOIN гарантирует, что ВСЕ студенты будут в результате, даже если у них нет оценок. Для студентов без оценок в полях subject и grade будут NULL значения.</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: students</th>
                <th>Таблица: grades</th>
                <th>Результат LEFT JOIN</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    id: 1, name: "Иван"<br>
                    id: 2, name: "Мария"<br>
                    id: 3, name: "Петр"
                </td>
                <td>
                    student_id: 1, subject: "Математика", grade: 5<br>
                    student_id: 2, subject: "Физика", grade: 4<br>
                    student_id: 4, subject: "Химия", grade: 3
                </td>
                <td>
                    Иван, Математика, 5<br>
                    Мария, Физика, 4<br>
                    Петр, NULL, NULL
                </td>
            </tr>
        </tbody>
    </table>

    <h2 id="right-join">RIGHT JOIN - правое соединение</h2>
    <p>RIGHT JOIN возвращает все строки из правой таблицы и соответствующие строки из левой таблицы. Если соответствий нет, возвращаются NULL значения.</p>

    <div class="example">
        <h3>Пример RIGHT JOIN</h3>
        <pre><code>SELECT 
    students.name,
    grades.subject,
    grades.grade
FROM students
RIGHT JOIN grades ON students.id = grades.student_id;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> RIGHT JOIN - это противоположность LEFT JOIN. Здесь гарантируется, что ВСЕ оценки будут в результате, даже если для них нет студента в таблице students.</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: students</th>
                <th>Таблица: grades</th>
                <th>Результат RIGHT JOIN</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    id: 1, name: "Иван"<br>
                    id: 2, name: "Мария"<br>
                    id: 3, name: "Петр"
                </td>
                <td>
                    student_id: 1, subject: "Математика", grade: 5<br>
                    student_id: 2, subject: "Физика", grade: 4<br>
                    student_id: 4, subject: "Химия", grade: 3
                </td>
                <td>
                    Иван, Математика, 5<br>
                    Мария, Физика, 4<br>
                    NULL, Химия, 3
                </td>
            </tr>
        </tbody>
    </table>

    <h2 id="full-join">FULL JOIN - полное соединение</h2>
    <p>FULL JOIN возвращает все строки из обеих таблиц. Если нет соответствия, для отсутствующих данных возвращаются NULL значения.</p>

    <div class="example">
        <h3>Пример FULL JOIN</h3>
        <pre><code>SELECT 
    students.name,
    grades.subject,
    grades.grade
FROM students
FULL JOIN grades ON students.id = grades.student_id;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> FULL JOIN объединяет в себе LEFT и RIGHT JOIN. Вы получите всех студентов (даже без оценок) и все оценки (даже без студентов).</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: students</th>
                <th>Таблица: grades</th>
                <th>Результат FULL JOIN</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    id: 1, name: "Иван"<br>
                    id: 2, name: "Мария"<br>
                    id: 3, name: "Петр"
                </td>
                <td>
                    student_id: 1, subject: "Математика", grade: 5<br>
                    student_id: 2, subject: "Физика", grade: 4<br>
                    student_id: 4, subject: "Химия", grade: 3
                </td>
                <td>
                    Иван, Математика, 5<br>
                    Мария, Физика, 4<br>
                    Петр, NULL, NULL<br>
                    NULL, Химия, 3
                </td>
            </tr>
        </tbody>
    </table>

    <div class="note">
        <p><strong>Примечание:</strong> FULL JOIN поддерживается не во всех СУБД. В MySQL, например, его можно эмулировать с помощью UNION LEFT JOIN и RIGHT JOIN.</p>
    </div>

    <h2 id="cross-join">CROSS JOIN - перекрёстное соединение</h2>
    <p>CROSS JOIN возвращает декартово произведение таблиц - каждая строка первой таблицы соединяется с каждой строкой второй таблицы.</p>

    <div class="example">
        <h3>Пример CROSS JOIN</h3>
        <pre><code>SELECT 
    products.name,
    colors.color_name
FROM products
CROSS JOIN colors;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> CROSS JOIN создает все возможные комбинации. Если в таблице products 3 товара, а в colors - 4 цвета, результат будет содержать 3 × 4 = 12 строк.</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: products</th>
                <th>Таблица: colors</th>
                <th>Результат CROSS JOIN</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    name: "Футболка"<br>
                    name: "Джинсы"<br>
                    name: "Куртка"
                </td>
                <td>
                    color_name: "Красный"<br>
                    color_name: "Синий"<br>
                    color_name: "Зеленый"
                </td>
                <td>
                    Футболка, Красный<br>
                    Футболка, Синий<br>
                    Футболка, Зеленый<br>
                    Джинсы, Красный<br>
                    Джинсы, Синий<br>
                    Джинсы, Зеленый<br>
                    Куртка, Красный<br>
                    Куртка, Синий<br>
                    Куртка, Зеленый
                </td>
            </tr>
        </tbody>
    </table>

    <h2 id="self-join">SELF JOIN - соединение таблицы с собой</h2>
    <p>SELF JOIN используется для соединения таблицы с самой собой. Это полезно для иерархических данных или когда нужно сравнить строки внутри одной таблицы.</p>

    <div class="example">
        <h3>Пример SELF JOIN (сотрудники и менеджеры)</h3>
        <pre><code>SELECT 
    e.name AS employee_name,
    m.name AS manager_name
FROM employees e
LEFT JOIN employees m ON e.manager_id = m.id;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> В таблице employees есть поле manager_id, которое ссылается на id другого сотрудника. SELF JOIN позволяет показать, кто чей менеджер.</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: employees</th>
                <th>Результат SELF JOIN</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    id: 1, name: "Анна", manager_id: NULL<br>
                    id: 2, name: "Борис", manager_id: 1<br>
                    id: 3, name: "Виктор", manager_id: 1<br>
                    id: 4, name: "Галина", manager_id: 2
                </td>
                <td>
                    Анна, NULL<br>
                    Борис, Анна<br>
                    Виктор, Анна<br>
                    Галина, Борис
                </td>
            </tr>
        </tbody>
    </table>

    <h2 id="multiple-joins">Множественные соединения</h2>
    <p>В одном запросе можно использовать несколько JOIN для соединения трех и более таблиц.</p>

    <div class="example">
        <h3>Пример множественных JOIN</h3>
        <pre><code>SELECT 
    students.name AS student_name,
    subjects.subject_name,
    grades.grade,
    teachers.name AS teacher_name
FROM students
INNER JOIN grades ON students.id = grades.student_id
INNER JOIN subjects ON grades.subject_id = subjects.id
LEFT JOIN teachers ON subjects.teacher_id = teachers.id;</code></pre>
    </div>

    <p><strong>Объяснение для новичков:</strong> Этот запрос соединяет 4 таблицы: студентов с оценками, оценки с предметами, и предметы с преподавателями. Порядок JOIN важен - каждое следующее соединение работает с результатом предыдущего.</p>

    <table>
        <thead>
            <tr>
                <th>Таблица: students</th>
                <th>Таблица: grades</th>
                <th>Таблица: subjects</th>
                <th>Таблица: teachers</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>id, name</td>
                <td>student_id, subject_id, grade</td>
                <td>id, subject_name, teacher_id</td>
                <td>id, name</td>
            </tr>
        </tbody>
    </table>

    <h2 id="performance">Производительность и оптимизация</h2>

    <table>
        <thead>
            <tr>
                <th>Рекомендация</th>
                <th>Пример</th>
                <th>Объяснение</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Используйте INNER JOIN вместо WHERE для соединений</td>
                <td>
                    <strong>Хорошо:</strong><br>
                    <code>SELECT ... FROM A INNER JOIN B ON A.id = B.id</code><br>
                    <strong>Плохо:</strong><br>
                    <code>SELECT ... FROM A, B WHERE A.id = B.id</code>
                </td>
                <td>Явные JOIN лучше читаются и оптимизируются</td>
            </tr>
            <tr>
                <td>Создавайте индексы на полях соединения</td>
                <td>
                    <code>CREATE INDEX idx_student_id ON grades(student_id);</code>
                </td>
                <td>Индексы значительно ускоряют поиск соответствий</td>
            </tr>
            <tr>
                <td>Ограничивайте количество возвращаемых строк</td>
                <td>
                    <code>SELECT ... LIMIT 100</code><br>
                    <code>SELECT ... WHERE condition</code>
                </td>
                <td>Меньше данных - быстрее выполнение</td>
            </tr>
            <tr>
                <td>Используйте только нужные столбцы</td>
                <td>
                    <strong>Хорошо:</strong><br>
                    <code>SELECT name, email FROM ...</code><br>
                    <strong>Плохо:</strong><br>
                    <code>SELECT * FROM ...</code>
                </td>
                <td>SELECT * загружает лишние данные</td>
            </tr>
        </tbody>
    </table>

    <div class="example">
        <h3>Пример оптимизированного запроса</h3>
        <pre><code>-- Создаем индексы для ускорения
CREATE INDEX idx_employee_department ON employees(department_id);
CREATE INDEX idx_department_name ON departments(name);

-- Оптимизированный запрос
SELECT 
    e.id,
    e.first_name,
    e.last_name,
    d.name AS department_name
FROM employees e
INNER JOIN departments d ON e.department_id = d.id
WHERE d.name = 'IT'
ORDER BY e.last_name
LIMIT 50;</code></pre>
    </div>

    <div class="navigation" id="navigation">
        <h3>Навигация по документации</h3>
        <p><strong>Теги:</strong> SQL, JOIN, INNER JOIN, LEFT JOIN, RIGHT JOIN, FULL JOIN, CROSS JOIN, SELF JOIN, базы данных</p>
        <p><strong>Связанные темы:</strong> <a href="#introduction">Введение</a> | <a href="#inner-join">INNER JOIN</a> | <a href="#left-join">LEFT JOIN</a> | <a href="#right-join">RIGHT JOIN</a> | <a href="#full-join">FULL JOIN</a> | <a href="#cross-join">CROSS JOIN</a> | <a href="#self-join">SELF JOIN</a> | <a href="#multiple-joins">Множественные JOIN</a> | <a href="#performance">Оптимизация</a></p>
        <p><strong>Дата создания:</strong> 2024</p>
        <p><strong>Версия:</strong> 1.0</p>
    </div>

</body>
</html>